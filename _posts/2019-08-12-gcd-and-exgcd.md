---
title: æœ€å¤§å…¬çº¦æ•°å’Œè¾—è½¬ç›¸é™¤æ³•
create_date: 2019-08-12
modify_date: 2019-09-06
categories: [gcd, algorithm]
---

æœ¬æ–‡æ˜¯æˆ‘å¯¹æœ€å¤§å…¬çº¦æ•°ç›¸å…³çŸ¥è¯†ç‚¹çš„å¤ä¹ å’Œæ€»ç»“ã€‚å¦å¤–æœ¬æ–‡ä¸€äº›ç¬¦å·çš„å«ä¹‰ã€ä¸€äº›æ¦‚å¿µçš„å®šä¹‰ä¹Ÿè®¸å’Œé€šå¸¸æœ‰äº›å‡ºå…¥ï¼Œä»¥åŠä½¿ç”¨äº†ä¸€äº›å…¶ä»–ç»“è®ºï¼Œè¯·è§æ–‡æœ«ã€ŒèƒŒæ™¯çŸ¥è¯†ã€ã€‚

**å¼€é—¨è§å±±**ã€‚


## æœ€å¤§å…¬çº¦æ•°ï¼ˆGreatest Common Divisorï¼‰

**æœ€å¤§å…¬çº¦æ•°**çš„æ¦‚å¿µæ˜¯æŒ‡ä¸¤ä¸ªæ•´æ•°å…±åŒçš„æœ€å¤§çš„çº¦æ•°ã€‚æ¯”å¦‚ï¼š $1, 2, 3, 6$ éƒ½æ˜¯ $6$ çš„çº¦æ•°ï¼Œ$1, 3, 9$ éƒ½æ˜¯æ˜¯ $9$ çº¦æ•°ã€‚é‚£ä¹ˆ $6$ å’Œ $9$ çš„æœ€å¤§å…¬çº¦æ•°ä¾¿æ˜¯ $3$ï¼Œ è®°ä½œ $\gcd(6, 9) = 3$ã€‚ ä¸€èˆ¬åœ°å¯¹äºä»»æ„ä¸¤ä¸ªæ•´æ•° $a, b$ï¼Œå…¶æœ€å¤§å…¬çº¦æ•°è®°ä¸º $\gcd(a, b)$ã€‚

æ˜ç¡®äº†æœ€å¤§å…¬çº¦æ•°çš„æ¦‚å¿µä¹‹åï¼Œæ¥ä¸‹æ¥åº”è¯¥è€ƒè™‘å¦‚ä½•æ±‚ä»»æ„ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°ä»¥åŠæœ€å¤§å…¬çº¦æ•°æœ‰å“ªäº›æ€§è´¨ã€‚


## è¾—è½¬ç›¸é™¤æ³•

æ±‚æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•æœ‰ç±»ä¼¼ä¸Šé¢çš„æŠŠä¸¤ä¸ªæ•´æ•°çš„æ‰€æœ‰çº¦æ•°éƒ½æ‰¾å‡ºæ¥ï¼Œæ‰¾å‡ºå…¶ä¸­æœ€å¤§çš„ç›¸åŒçš„çº¦æ•°ï¼›ä¸­å›½å¤ä»£ä¹Ÿæœ‰æ±‚æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•ï¼Œã€Œä¹ç« ç®—æœ¯ã€ä¸­æåˆ°äº†ã€Œæ›´ç›¸å‡æŸæœ¯ã€ï¼Œæœ¬è´¨ä¸Šå’Œæ¥ä¸‹æ¥è®¨è®ºçš„è¾—è½¬ç›¸é™¤æ³•ä¸€æ ·çš„ï¼Œåªæ˜¯æŠŠé™¤æ³•æ¢æˆäº†å¤šæ¬¡å‡æ³•ï¼›è¿˜æœ‰å°±æ˜¯è¿™é‡Œä¸»è¦è®¨è®ºçš„è¾—è½¬ç›¸é™¤æ³•ä»¥åŠä»æœ€å¤§å…¬çº¦æ•°æ€§è´¨å¾—åˆ°çš„å¦å¤–ä¸€ä¸ªç®—æ³•ã€‚

**è¾—è½¬ç›¸é™¤æ³•**ï¼ˆä¹Ÿå«æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰æ˜¯æœ€å¸¸ç”¨æ±‚è§£ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•ã€‚è¾—è½¬ç›¸é™¤æ³•ç®—æ³•æ­¥éª¤å¦‚ä¸‹ï¼š
```text
è¾“å…¥ï¼šä¸¤ä¸ªæ•´æ•° a, b
è¾“å‡ºï¼ša, b

step-1. å¦‚æœ b ç­‰äº 0ï¼Œé‚£ä¹ˆ a å’Œ b çš„æœ€å¤§å…¬çº¦æ•°ä¾¿æ˜¯ aï¼›å¦åˆ™æ‰§è¡Œ step-2
step-2. ä»¤ a' = b, b' = a % bï¼Œæ‰§è¡Œ step-3
step-3. ä»¤ a = a', b = b'ï¼Œæ‰§è¡Œ step-1
```

ä¸¾ä¸€ä¸ªä¾‹å­ğŸŒ°ï¼šæ±‚ $6$ å’Œ $9$ çš„æœ€å¤§å…¬çº¦æ•°ã€‚
```text
è¾“å…¥ï¼ša = 6ï¼Œb = 9

1. ç”±äº 9 ä¸ç­‰äº 0ï¼Œé‚£ä¹ˆæ‰§è¡Œ step-2
2. a' = 9, b' = 6 % 9 = 6 ï¼ˆå› ä¸º 6 = 0 Ã— 9 + 6ï¼‰
3. a = 9, b = 6
4. ç”±äº 6 ä¸ç­‰äº 0ï¼Œé‚£ä¹ˆæ‰§è¡Œ step-2
5. a' = 6, b' = 9 % 6 = 3 ï¼ˆå› ä¸º 9 = 1 Ã— 6 + 3ï¼‰
6. a = 6, b = 3
7. ç”±äº 3 ä¸ç­‰äº 0ï¼Œé‚£ä¹ˆæ‰§è¡Œ step-2
8. a' = 3, b' = 6 % 3 = 0 ï¼ˆå› ä¸º 6 = 2 Ã— 3 + 0ï¼‰
9. a = 3, b = 0
10. ç”±äº b ç°åœ¨æ˜¯ 0ï¼Œæ‰€ä»¥ç¨‹åºç»“æŸå¹¶è¾“å‡º 3
```

æ ¹æ®ä¸Šé¢çš„åˆ†æå¯ä»¥å†™å‡ºç›¸åº”çš„ C ç¨‹åºæˆ–å…¶ä»–è¯­è¨€çš„ä»£ç ã€‚
```c
int gcd(int a, int b)
{
    while (b != 0) {
        int aa = b, bb = a%b;
        a = aa;
        b = bb;
    }

    return a;
}
```


## æ­£ç¡®æ€§å’Œæ—¶é—´å¤æ‚åº¦

### æ­£ç¡®æ€§

ç”±äºä»»æ„ä¸¤ä¸ªæ•´æ•°ä¸€å®šå­˜åœ¨æœ€å¤§å…¬çº¦æ•°ï¼ˆæ— è®ºå¦‚ä½• $1$ éƒ½æ˜¯ä»»æ„æ•´æ•°çš„çº¦æ•°ï¼‰ï¼Œä¸å¦¨è®° $g = \gcd(a, b)$ï¼Œé‚£ä¹ˆå¯¹äº $a$ å’Œ $b$ å¯ä»¥å†™æˆï¼š

$$
\begin{align}
a &= g \times k_1 \\
b &= g \times k_2
\end{align}
$$

æ¥ä¸‹æ¥è¯æ˜ï¼Œ$a$ é™¤ä»¥ $b$ çš„ä½™æ•° $r$ ä¸ $b$ çš„æœ€å¤§å…¬çº¦æ•°ä¹Ÿæ˜¯ $g$ï¼Œä¹Ÿå°±æ˜¯ $\gcd(a, b) = \gcd(b, a\%b)$ã€‚ç”±äº $r$ æ˜¯ $a$ é™¤ä»¥ $b$ çš„ä½™æ•°

$$
\begin{align}
a &= k \times b + r \\
r &= a - k \times b \\
  &= g \times k_1 - k \times g \times k_2 \\
  &= g \times (k_1 - k \times k_2) \\
\end{align}
$$

è¿™é‡Œå¾—åˆ° $g$ æ˜¯ $r$ çš„çº¦æ•°ã€‚å¹¶ä¸”ç”±äº $k_1 - k \times k_2$ å’Œ $k_2$ ä¹‹é—´ä¸ä¼šæœ‰å…¶ä»–é $1$ çš„å…¬çº¦æ•°ï¼Œé‚£ä¹ˆ $r$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ä¹Ÿæ˜¯ $g$ã€‚è¿™æ˜¯ç”±äº $k_1$ å’Œ $k_2$ ä¹‹é—´ä¸ä¼šæœ‰å…¶é $1$ å…¬çº¦æ•°ï¼Œé‚£ä¹ˆ $\frac{k_1 - k \times k_2}{k_2} = \frac{k_1}{k_2} - k$ ä¸€å®šä¸æ˜¯æ•´æ•°ã€‚

è¿™å°±è¯´æ˜ $\gcd(a_0, b_0) = \gcd(a_1, b_1) = \cdots = \gcd(a_n, b_n)$ å…¶ä¸­ $a_i = b_{i-1}, b_i = a_{i-1}\%b_{i-1}, \forall i \ge 1, a_0 = a, b_0 = b$ï¼Œå½“ $b_n = 0$ æ—¶ï¼Œ$a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•° $g = \gcd(a_n, b_n) = \gcd(a_n, 0) = a_n$ã€‚

ä¸Šè¿°åºåˆ—çš„æ”¶æ•›æ€§ï¼šç”±äº $b_i = a_{i-1}\%b_{i-1}$ é‚£ä¹ˆç”±ä½™æ•°å®šä¹‰å¯çŸ¥ $b_{i-1} > b_i$ã€‚é‚£ä¹ˆåºåˆ— $b_0, b_1, \dots, b_{n-1}, b_n$ ä¸€å®šæ˜¯é€’å‡ä¸”è‡³å°‘å‡å°‘ $1$ï¼Œå¯¹äºä»»æ„ä¸€é¡¹ $b_i$ ä¸º $a_{i-1}$ çš„ä½™æ•°ï¼Œé‚£ä¹ˆ $b_i \ge 0$ã€‚ $b_i$ å•è°ƒå‡å°‘å¹¶ä¸”æœ‰ä¸‹ç•Œï¼Œé‚£ä¹ˆ $b_i$ ä¸€å®šæ”¶æ•›åˆ° $0$ï¼Œè¯´æ˜æ­¤ç®—æ³•æ˜¯æ”¶æ•›çš„ï¼Œä¹Ÿå°±æ˜¯ $b_n = 0$ ä¸€å®šèƒ½å–åˆ°ã€‚


### æ—¶é—´å¤æ‚åº¦

ç”±ä¸Šé¢è¯æ˜å¯ä»¥çŸ¥é“ï¼Œæ­¤ç®—æ³•ä¹Ÿå°±æ˜¯é€šè¿‡æ±‚ä½™è¿ç®—æŠŠè¾“å…¥çš„**æ•°å¯¹** $(a, b)$ ä¸€æ­¥æ­¥å˜æ¢åˆ° $(g, 0)$ï¼Œçš„è¿‡ç¨‹ï¼Œè¿™é‡Œçš„ $g$ ä¹Ÿå°±æ˜¯ $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ã€‚è¿˜æ˜¯ä»¥ $6$ å’Œ $9$ çš„æœ€å¤§å…¬çº¦æ•°çš„è®¡ç®—è¿‡ç¨‹ä¸ºä¾‹ï¼Œä¸Šè¿°è¿‡ç¨‹å¯ä»¥çœ‹æˆ $(6, 9) \to (9, 6) \to (6, 3) \to (3, 0)$ã€‚å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¿ç®—éƒ½ä¼šä½¿å¾— $a$ å’Œ $b$ çš„ç»å¯¹å€¼å‡å°‘ï¼Œå¹¶ä¸”å¦‚æœ $a$ å’Œ $b$ ä¸­å­˜åœ¨è´Ÿæ•°çš„è¯ï¼Œç»è¿‡æœ€å¤šä¸¤æ¬¡å˜æ¢å°±èƒ½å¾—åˆ°æ±‚ä¸¤ä¸ªæ­£æ•°çš„æœ€å¤§å…¬çº¦æ•°ã€‚å¦‚æœæŠŠæ­¤è¿‡ç¨‹äº§ç”Ÿä¸€ç³»åˆ—æ•°å¯¹çœ‹æˆä¸€ä¸ªæ•°åˆ—ï¼Œåˆ†æä¸‹è¿™ä¸ªæ•°åˆ—å’Œã€Œæ–æ³¢é‚£å¥‘æ•°åˆ—ã€çš„å…³ç³»ï¼Œä¹Ÿè®¸èƒ½å¾—åˆ°æ•°åˆ—é•¿åº¦ï¼Œä¹Ÿå°±åæ˜ äº†ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚

å…·ä½“æ¥è¯´ï¼Œè€ƒè™‘æ­¤è¿‡ç¨‹ä¸­ä¸¤æ¬¡è¿ç»­çš„å˜æ¢è¿‡ç¨‹ $(a_{i-1}, b_{i-1}) \to (a_i, b_i) \to (a_{i+1}, b_{i+1})$ï¼Œæ­¤æ—¶ $a_{i-1}, b_{i-1}, a_i, b_i, a_{i+1}, b_{i+1} \ge 0$ å¹¶ä¸” $ a_{i-1} > b_{i-1}, a_i > b_i, a_{i+1} > b_{i+1}$ã€‚

$$
\begin{array}{rll}
a_i     &= b_{i-1} \\
b_i     &= a_{i-1} \% b_{i-1} &= a_{i-1} - k_{i-1} \times b_{i-1}  \\
a_{i+1} &= b_i \\
b_{i+1} &= a_i \% b_i         &= a_i - k_i \times b_i \\
\end{array}
$$

é‚£ä¹ˆå¯¹äº $b_i + b_{i+1}$ æœ‰

$$
\begin{align}
b_i + b_{i+1} &= b_i + a_i - k_i \times b_i \\
              &= a_i + (1 - k_i) \times b_i \\
              &= b_{i-1} + (1 - k_i) \times b_i \\
              &\le b_{i-1} \\
\end{align}
$$

ä¹Ÿå°±æ˜¯ $b_{i-1} \ge b_i + b_{i+1}$, å†è€ƒè™‘ $b$ å’Œ $Fib(n)$ çš„å…³ç³»

$$
\begin{array}{llll}
b_n     &= 0               &\ge 0               &= Fib(0) \\
b_{n-1} &= a_n             &\ge 1               &= Fib(1) \\
b_{n-2} &\ge b_{n-1} + b_n &\ge Fib(1) + Fib(0) &= Fib(2) \\
\dots \\
b_1     &\ge b_2 + b_3     &\ge Fib(n-2) + Fib(n-3) &= Fib(n-1) \\
b_0     &\ge b_1 + b_2     &\ge Fib(n-1) + Fib(n-2) &= Fib(n) \\
\end{array}
$$

é‚£ä¹ˆ $b = b_0 \ge Fib(n) \approx \frac{1}{5} \phi^n$ï¼Œä¸¤è¾¹æ±‚å¯¹æ•° $n \le (\log \phi - \log \sqrt{5}) \log b$ï¼Œä¹Ÿå°±æ˜¯

$$
n = \Omicron (\log b)
$$

å¾—åˆ°ç»“è®ºï¼šè¾—è½¬ç›¸é™¤æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º $\Omicron (\log b)$ï¼Œ è¿™é‡Œ $b$ ä¸ºå¾…æ±‚çš„ä¸¤ä¸ªæ•´æ•°ä¸­ç»å¯¹å€¼å°çš„é‚£ä¸€ä¸ªã€‚


## æœ€å¤§å…¬çº¦æ•°çš„æ€§è´¨

æœ€å¤§å…¬çº¦æ•°å…·æœ‰å¦‚ä¸‹æ€§è´¨ï¼š

$$
\begin{align}
\gcd(a, 0) &= a \\
\gcd(a, b) &= \gcd(b, a) \\
\gcd(a, b) &= \gcd(\vert a \vert, \vert b \vert) \\
\gcd(a, b) &= \gcd(b, a-b)\quad \text{å‡å®š}\ a \ge b \tag{attr-1} \\
\gcd(a, b) &= \gcd(b, a\%b) \\
\gcd(a, b) &= k \times \gcd(a/k, b/k)\quad  \text{å¦‚æœ} \  k \mid a,\, k \mid b \tag{attr-2} \\
\gcd(a, b) &= \gcd(a, b/k)\quad \text{å¦‚æœ} \  k \nmid a, \, k \mid b \tag{attr-3} \\
\gcd(a, b) &= 1\quad \text{å¦‚æœ}\  a, b \ \text{æ˜¯è´¨æ•°} \\
\gcd(a, bc) &= \gcd(a, b) \gcd(a, c) \\
\gcd(a, b, c) &= \gcd(a, \gcd(b, c)) = \gcd(\gcd(a, b), c) \\
\end{align}
$$

ä¸Šè¿°æ€§è´¨ä¸éš¾è¯æ˜ã€‚æ­¤å¤–å¦‚æœ $\gcd(a, b) = 1$ï¼Œç§° $a, b$ äº’è´¨ã€‚


### æœ€å¤§å…¬çº¦æ•°çš„å‡ ä½•è§£é‡Š

æœ€å¤§å…¬çº¦æ•°ä»å‡ ä½•è§’åº¦æ¥çœ‹çš„è¯ï¼Œ$n = \gcd(a, b) + 1 = g + 1$ è¡¨æ˜çº¿æ®µ `(0, 0) -- (a, b)` ç»è¿‡äº† $g + 1$ ä¸ªæ•´æ•°åæ ‡ç‚¹ã€‚å› ä¸º $a = g \times a'$ï¼Œå¯ä»¥ç†è§£ä¸º $g$ ä¸ª $a$ ç›¸åŠ ï¼Œåæ˜ åˆ°åæ ‡è½´ä¸Šå°±æ˜¯ $g$ æ®µç­‰é•¿çº¿æ®µ $a'$ æ„æˆäº†çº¿æ®µ $a$ã€‚

ä¾‹å¦‚ï¼š $\gcd(9, 6) = 3$ï¼Œçº¿æ®µ `(0, 0) -- (9, 6)` ç»è¿‡äº† `(0, 0)`ã€`(3, 2)`ã€`(6, 4)` å’Œ `(9, 6)` è¿™å››ä¸ªæ•´æ•°åæ ‡ç‚¹ã€‚

![gcd(9, 6) = 3](/images/gcd-geometry-explaintion.svg)


### è´ç¥–ç­‰å¼

**è´ç¥–ç­‰å¼**æ˜¯æŒ‡å¯¹äºä»»æ„æ•´æ•° $a, b$ ä¸€å®šå­˜åœ¨æ•´æ•° $x, y$ ä½¿å¾—ï¼Œ$x \times a + y \times b = \gcd(a, b)$ã€‚

ä»ä¸Šè¿°å°èŠ‚ã€Œæ—¶é—´å¤æ‚åº¦ã€ä¸­çš„æ•°å¯¹å˜æ¢æ¥æ¨å¯¼å¯ä»¥è½»æ¾å¾—åˆ°æ­¤ç»“è®ºï¼Œå¹¶ä¸”ç”±æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•èƒ½è§£å‡º $x$ å’Œ $y$ï¼Œèƒ½å¾—åˆ°æ‰€è°“çš„æ¨¡ $m$ è¿ç®—ä¸‹çš„**é€†å…ƒ**ã€‚

æ•°å¯¹ $(a_{i-1}, b_{i-1})$ å˜æ¢åˆ° $(a_i, b_i)$ï¼Œä¹Ÿå°±æ˜¯ $a_i = b_{i-1},\, b_i = a_{i-1} - k_{i-1} \times b_{i-1}$ å¯ä»¥å†™æˆçŸ©é˜µå½¢å¼

$$
\begin{bmatrix}
0 & 1 \\
1 & -k_{i-1} \\
\end{bmatrix}
\begin{bmatrix}
a_{i-1} \\
b_{i-1} \\
\end{bmatrix}
=
\begin{bmatrix}
a_i \\
b_i \\
\end{bmatrix}
$$

è¿™ä¸ªè¿‡ç¨‹ä»$(a_0, b_0)$ ï¼ˆä¹Ÿå°±æ˜¯ $(a, b)$ï¼‰å¼€å§‹ä¸åœå˜æ¢ä¸‹å»ç›´åˆ° $b_n = 0$ï¼Œå¾—åˆ°

$$
\begin{bmatrix}
0 & 1 \\
1 & -k_{n-1} \\
\end{bmatrix}
\cdots
\begin{bmatrix}
0 & 1 \\
1 & -k_1 \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & -k_0 \\
\end{bmatrix}
\begin{bmatrix}
a_0 \\
b_0 \\
\end{bmatrix}
=
\begin{bmatrix}
a_n \\
b_n \\
\end{bmatrix}
=
\begin{bmatrix}
a_n \\
0 \\
\end{bmatrix}
\tag{eq-1}
$$

å…¶ä¸­ $k_i = \left \lfloor \frac{a_i}{b_i} \right \rfloor$ã€‚ä¸Šè¿°ä»»æ„ä¸€ä¸ªçŸ©é˜µå…¶è¡Œåˆ—å¼ä¸º $-1 \neq 0$ï¼Œé‚£ä¹ˆè¿™äº›çŸ©é˜µç›¸ä¹˜å¾—åˆ°

$$
\begin{bmatrix}
x  & y\\
k  & m\\
\end{bmatrix}
\begin{bmatrix}
a_0 \\
b_0 \\
\end{bmatrix}
=
\begin{bmatrix}
a_n \\
0 \\
\end{bmatrix}
$$

è¿™é‡Œ $x, y, k, m$ éƒ½æ˜¯å¯ä»¥ç¡®å®šçš„æ•´æ•°ï¼Œå¹¶ä¸” $x \times a_0 + y \times b_0 = a_n \Rightarrow x \times a + y \times b = \gcd(a, b)$ è¿™ä¾¿æ˜¯è´ç¥–ç­‰å¼ã€‚

ç‰¹åˆ«åœ°ï¼Œä»¤ $b = m$ ä¸” $a, m$ äº’è´¨ï¼Œä¾¿æœ‰ $x \times a + y \times m = \gcd(a, m) = 1$ï¼Œå†å¯¹ä¸¤è¾¹éƒ½æ±‚ $m$ çš„ä½™æ•°å¾—åˆ°

$$
x \times a \equiv 1 \pmod{m}
$$

è¿™è¡¨ç¤º $x \times a$ å’Œ $1$ åœ¨æ¨¡ $m$ ä¸‹**åŒä½™**ï¼Œå…¶ä¸­ $x$ ä¸º $a$ åœ¨æ¨¡ $m$ ä¸‹çš„é€†å…ƒã€‚


## æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

è´ç¥–ç­‰å¼ä¸­çš„ $x, y$ å¯ä»¥é€šè¿‡ (eq-1) ä¸­è®¡ç®—çŸ©é˜µè¿ä¹˜å¾—åˆ°ï¼Œè®¡ç®—è¿‡ç¨‹æ—¢å¯ä»¥ä»å³å‘å·¦è®¡ç®—ï¼Œè¿™æ ·å¥½å¤„ä¸éœ€è¦é€’å½’åªéœ€è¦è¿­ä»£å³å¯ï¼Œä½†æ˜¯è¦ç»´æŠ¤ä¸€ä¸ªçŸ©é˜µï¼ˆå››ä¸ªæ•°ï¼‰ï¼›ä¹Ÿå¯ä»¥ä»å·¦å‘å³è®¡ç®—ï¼Œå¥½å¤„æ˜¯åªéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæ•° $x, y$ï¼Œä½†æ˜¯éœ€è¦é€’å½’è®¡ç®—ï¼ˆå¥½åœ¨è¿™ä¸ªé€’å½’ä¸æ·±äº$\log b$ï¼‰ã€‚è¿™é‡Œé‡‡å–ç¬¬äºŒç§æ–¹æ³•ï¼Œå¯¹äº (eq-1) æŠŠ $x, y$ æ·»åŠ è¿›å»ï¼Œ`?` è¡¨ç¤ºä¸å…³å¿ƒè¿™ä¸ªæ•°æ˜¯å¤šå°‘ï¼Œä¹Ÿä¸éœ€è¦è®¡ç®—ã€‚

$$
\begin{bmatrix}
x_0 & y_0 \\
? & ? \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & -k_{n-1} \\
\end{bmatrix}
\cdots
\begin{bmatrix}
0 & 1 \\
1 & -k_1 \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & -k_0 \\
\end{bmatrix}
=
\begin{bmatrix}
x_1 & y_1 \\
? & ? \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & -k_{n-2} \\
\end{bmatrix}
\cdots
\begin{bmatrix}
0 & 1 \\
1 & -k_1 \\
\end{bmatrix}
\begin{bmatrix}
0 & 1 \\
1 & -k_0 \\
\end{bmatrix}
$$

è€ƒå¯Ÿ $x_{i-1}, y_{i-1}$ ä¸ $x_i, y_i$ çš„å…³ç³»ï¼Œæœ‰

$$
\begin{align}
x_i &= y_{i-1} \\
y_i &= x_{i-1}-k_{n-i} \times y_{i-1} = x_{i-1}-\left \lfloor \frac{a_{n-i}}{b_{n-i}} \right \rfloor \times y_{i-1}\\
x_0 &= 1 \\
y_0 &= 0 \\
\end{align}
$$

å¯ä»¥å‘ç°æ­¤å¼å­å’Œæ±‚æœ€å¤§å…¬çº¦æ•°çš„å˜æ¢è¿‡ç¨‹å¾ˆç±»ä¼¼ $a_i = b_{i-1},\, b_i = a_{i-1} - k_{i-1} \times b_{i-1}$ã€‚

æŒ‰ç…§æ­¤å…³ç³»å¾—åˆ°æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

```c
/**
 * è¾“å…¥ä¸¤ä¸ªæ•´æ•° a, b å’Œå­˜å‚¨ x å’Œ y çš„ç»“æœçš„æŒ‡é’ˆ
 * å‡½æ•°è¿”å›å€¼ä¸º a å’Œ b çš„æœ€å¤§å…¬çº¦æ•°
 */
int exgcd(int a, int b, int *x, int *y)
{
    if (0 == b) {
        *x = 1;
        *y = 0;
        return a;
    }
    int x1, y1;
    int g = exgcd(b, a%b, &x1, &y1);
    *x = y1;
    *y = x1 -a/b * y1;          /* C è¯­è¨€é‡Œè¿ç®—ç¬¦ / å¯¹æ•´æ•°ä¾¿æ˜¯ä¸‹å–æ•´ */
    return g;
}
```

### æ¨¡ $m$ é€†å…ƒ

å¯¹æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•åšç®€å•æ”¹è¿›å¾—åˆ°æ±‚é€†å…ƒçš„ç®—æ³•

```c
int inv(int a, int m)
{
    int x, _, g;
    g = exgcd(a, m, &x, &_);
    if (1 != g)
        return -1;      /* a å’Œ m å¹¶ä¸äº’è´¨ */

    /* é€†å…ƒä¸€èˆ¬å®šä¹‰ä¸ºæ­£æ•°ï¼Œä¸”å°äºæ¨¡ m */
    if (x < 0)
        return x+m;
    else
        return x;
}
```

## å¦ä¸€ç§æ±‚æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•

æœ€åä»¥ä¸€ç§ä¸éœ€è¦ã€Œé™¤æ³•ã€çš„ç®—æ³•æ¥æ±‚æœ€å¤§å…¬çº¦æ•°ä½œä¸ºæœ¬æ–‡çš„ç»“æŸã€‚æ‰€è°“çš„ä¸éœ€è¦é™¤æ³•æ˜¯æŒ‡é‡Œé¢ä»…æœ‰çš„é™¤æ³•ä¾¿æ˜¯é™¤ä»¥ $2$ï¼Œè¿™ä¸ªå¯ä»¥å†™æˆäºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„å³ä½ç§»ä¸€ä½çš„å½¢å¼ã€‚

åœ¨ç°åœ¨åŸºäºäºŒè¿›åˆ¶çš„è®¡ç®—æœºé‡Œï¼Œ$2 * a \Leftrightarrow a \ll 1$ å¹¶ä¸” $ a/2 \Leftrightarrow a \gg 1$ï¼Œè¿™é‡Œçš„ $\ll$ å’Œ $\gg$ è¡¨ç¤ºå³ä½ç§»å’Œå·¦ä½ç§»ã€‚

```text
è¾“å…¥ï¼šè¾“å…¥ä¸¤ä¸ªæ­£æ•´æ•° a, b
è¾“å‡ºï¼ša, b çš„æœ€å¤§å…¬çº¦æ•°
è¾…åŠ©å˜é‡ï¼šg = 1

step-1. å¦‚æœ b ç­‰äº 0ï¼Œæœ€å¤§å…¬çº¦æ•°å°±æ˜¯ g*aï¼›å¦åˆ™æ‰§è¡Œ step-2
step-2. å¦‚æœ a å’Œ b éƒ½æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆ g = g<<1ï¼Œ a = a>>1, b = b>>1ï¼›å¦åˆ™æ‰§è¡Œ step-3
step-3. å¦‚æœ a æ˜¯å¶æ•°ï¼Œb æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆ a = a>>1ï¼›å¦åˆ™æ‰§è¡Œ step-4
step-4. å¦‚æœ b æ˜¯å¶æ•°ï¼Œa æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆ b = b>>1ï¼›å¦åˆ™æ‰§è¡Œ step-5
step-5. å¦‚æœ a å’Œ b éƒ½æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆ a' = b, b' = abs(a-b)ï¼Œa = a', b = b'ï¼Œæ‰§è¡Œ step-1
```

`step-2` çš„æ­£ç¡®æ€§ç”± (attr-2) ä¿è¯ï¼Œ `step-3` å’Œ `step-4` çš„æ­£ç¡®æ€§ç”± (attr-3) ä¿è¯ï¼Œ`step-5` çš„æ­£ç¡®æ€§ç”± (attr-1) ä¿è¯ã€‚è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯ $\Omicron(\log b)$ï¼Œè¿™é‡Œä¸åšè¯æ˜ï¼ˆä»å­˜åœ¨é™¤ä»¥ $2$ å…¥æ‰‹å¯ä»¥è¯æ˜ï¼‰ã€‚

ä¸‹é¢ç»™å‡ºä¸€ä¸ª C è¯­è¨€å®ç°
```c
#define abs(x)  ((x)<0? -(x): (x))

int gcd2(int a, int b)
{
    int g = 1;
    while (b != 0) {
        if (a&1 && b&1) {
            int t = a;
            a = b;
            b = abs(t-b);
        } else if (a&1) {
            b >>= 1;
        } else if (b&1) {
            a >>= 1;
        } else {
            g <<= 1;
            a >>= 1;
            b >>= 1;
        }
    }

    return g*a;
}
```


## èƒŒæ™¯çŸ¥è¯†

* çº¦æ•°ã€æ•´é™¤

å¯¹äºä»»æ„æ•´æ•° $n$ï¼ˆåŒ…æ‹¬æ­£æ•´æ•°å’Œè´Ÿæ•´æ•°ï¼‰ï¼Œå…¶çº¦æ•°æ˜¯æŒ‡å­˜åœ¨**æ­£**æ•´æ•° $m$ å’Œæ•´æ•° $k$ ä½¿å¾— $n = k \times m$ æˆç«‹ï¼Œé‚£ä¹ˆç§°æ­£æ•´æ•° $m$ ä¸º $n$ çš„**æ­£çº¦æ•°**ï¼Œç®€ç§°**çº¦æ•°**ã€‚è¿™é‡Œçš„æ¦‚å¿µé™åˆ¶äº†çº¦æ•°åªèƒ½æ˜¯æ­£æ•´æ•°ï¼Œå…¶å®å¦‚æœå…è®¸çº¦æ•°æ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆ $k$ ä¹Ÿæ˜¯çº¦æ•°ï¼Œè¿™ä¸¤ç§å®šä¹‰æ²¡æœ‰å¤šå¤§å·®åˆ«ã€‚

ä¾‹å¦‚ï¼š$-6$ çš„çº¦æ•°å’Œ $6$ çš„çº¦æ•°ä¸€æ ·éƒ½æ˜¯ $1, 2, 3, 6$ã€‚

å¦‚æœ $m$ æ˜¯ $n$ çš„çº¦æ•°ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯ $m$ èƒ½æ•´é™¤ $n$ï¼Œè®°ä½œ $m \mid n$ï¼Œå¦‚æœ $m$ ä¸èƒ½æ•´é™¤ $n$ï¼Œè®°ä½œ $m \nmid n$ã€‚

* ä½™æ•°

å¯¹äºä»»æ„æ•´æ•° $n$ å’Œéé›¶æ•´æ•° $m$ï¼Œå­˜åœ¨å”¯ä¸€æ•´æ•° $k$ å’Œ $r$ ï¼ˆè¿™é‡Œ $0 \le r < \vert m \vert$ï¼‰ï¼Œä½¿å¾— $n = k \times m + r$ æˆç«‹ï¼Œé‚£ä¹ˆ $r$ ä¾¿æ˜¯ $n$ é™¤ä»¥ $m$ çš„**ä½™æ•°**ã€‚è®°ä½œ $ r = n \mod m$ æˆ–è€… $r = n\%k$ã€‚

ä¾‹å¦‚ï¼š$6$ é™¤ä»¥ $4$ çš„ä½™æ•°æ˜¯ $2$ï¼Œå› ä¸º $6 = 1 \times 4 + 2$ã€‚

* ä¸‹å–æ•´

å¯¹ä¸€ä¸ªå®æ•°å‘ä¸‹å–æ•´ï¼Œæ˜¯æŒ‡è¿™æ ·çš„ä¸€ä¸ªå‡½æ•° $y = \lfloor x \rfloor,\  x \in \mathbb{R}$ï¼ŒæŠŠå®æ•° $x$ æ˜ å°„åˆ°å°äºè‡ªèº«çš„æœ€å¤§çš„æ•´æ•° $y$ã€‚

æ¯”å¦‚ï¼š$\lfloor 0.5 \rfloor = 0$ã€$\lfloor -0.2 \rfloor = -1$ã€‚

* æ–æ³¢é‚£å¥‘æ•°åˆ—

**æ–æ³¢é‚£å¥‘æ•°åˆ—**æ˜¯æŒ‡è¿™æ ·çš„æ•°åˆ—ï¼š

$$1, 1, 2, 3, 5, 8, 13,, 21, \cdots$$

å…¶åä¸€é¡¹æ˜¯å‰ä¸¤é¡¹çš„å’Œï¼Œå¹¶ä¸”ç¬¬ä¸€é¡¹å’Œç¬¬äºŒé¡¹æ˜¯ $1$ã€‚é€’å½’å®šä¹‰å¦‚ä¸‹ï¼š

$$
Fib(n) = \begin{cases}
0 & n = 0 \\
1 & n = 1 \\
Fib(n-1) + Fib(n-2) & n \ge 2 \\
\end{cases}
$$

å¹¶ä¸”é€šé¡¹æ˜¯

$$
\begin{align}
Fib(n) &= \frac{1}{\sqrt{5}} \left[\left(\frac{1+\sqrt{5}}{2}\right)^n - \left(\frac{1-\sqrt{5}}{2}\right)^n\right] \\
       &\approx \frac{1}{\sqrt{5}} \phi^n \\
\end{align}
$$

å…¶ä¸­ $\phi = \frac{1+\sqrt{5}}{2}$ã€‚æ­¤é€šé¡¹å…¬å¼å¯ä»å˜æ¢è§’åº¦å¹¶ä¸”å½’çº¦å˜æ¢å¾—åˆ°ï¼Œä¹Ÿå¯ä»¥ä»å¾…å®šç³»æ•°å¹¶è§£ä¸¤ä¸ªç³»æ•°æ–¹ç¨‹å¾—åˆ°ã€‚

* çŸ©é˜µä¹˜æ³•

ä¸€ä¸ªçŸ©é˜µä¾¿æ˜¯ä¸€ä¸ªå˜æ¢ï¼ŒçŸ©é˜µä¹Ÿæ˜¯ä¿¡æ¯çš„è®°å½•æ–¹å¼ã€‚

æ–¹ç¨‹ç»„

$$
\begin{cases}
a \times x + b \times y &= e \\
c \times x + d \times y &= f \\
\end{cases}
$$

å¯ä»¥å†™æˆçŸ©é˜µå‘é‡ç›¸ä¹˜çš„å½¢å¼

$$
\begin{bmatrix}
a & b \\
c & d \\
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
\end{bmatrix}
=
\begin{bmatrix}
e \\
f \\
\end{bmatrix}
$$


## å‚è€ƒèµ„æ–™

1. è®¡ç®—æœºç¨‹åºè®¾è®¡è‰ºæœ¯ã€å·2ã€‘
